
<div class="modal fade" id="loading">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
		 <div class="text-center">
			 <img src="/images/loading.gif" alt="">
		 </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<!-- <div class="modal fade" id="pollModal">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
					<span class="sr-only">Close</span>
				</button>
				<h4 class="modal-title">Search Results</h4>
			</div>
			<div class="modal-body">
				<ul class="list-inline" id="colData">
					<li id="colPU"><span></span> <strong>Polling Units</strong></li>
					<li>matched your search result: <span id="searchQuery"></span></li>
				</ul>
				<div id="HoldCard">

				</div>
				<div class="clearfix"></div>
			</div>
			<div class="modal-footer">
				<div id="page-selection"></div>
			</div>
		</div>
		/.modal-content
	</div>
	/.modal-dialog
</div>
/.modal -->

<div class="container">
 <div class="d-flex flex-column">
 	<div class="d-flex flex-column w-50 fullM mr-auto ml-auto p-4 mt-4 mb-4">
		<div id="accordion" aria-expanded="false" role="tablist">
		  <div class="card">
		    <div class="card-header" role="tab" id="headingOne">
				<h5 data-toggle="collapse" href="#collapseOne" role="button" aria-expanded="true" aria-controls="collapseOne">Already Registered <small>Please clickhere</small></h5>
		    </div>
			 <div id="collapseOne" class="collapse hide" role="tabpanel" aria-labelledby="headingOne" data-parent="#accordion">
		      <div class="card-body">
					<form id="getLogin" action="/login" method="post">
						<p>If this is your first time here please scroll down and fill the form below thank you</p>
						<div class="form-group">
							<label for="loginName">Full Name</label>
							<input type="text" name="full_name" class="form-control" id="loginName" placeholder="">
						</div>
						<div class="form-group">
							<label for="loginPassword">Phone</label>
							<input type="text" id="loginPassword" name="phone_number" class="form-control" placeholder="Phone Number">
							<p class="help-block" id="logErr">Use Your Phone Number</p>
						</div>
						<button type="submit" id="loginBTN" class="btn btn-primary btn-lg">Log In</button>
					</form>
		      </div>
		    </div>
		  </div>
	  </div>
 	</div>
	<form id="register" class="border border-2 p-4 mb-4" action="" method="post">
		<h2>Registration <br><small class="text-muted">Please fill the form</small> </h2>
		<div class="d-flex flex-column flex-xl-row flex-md-row">
			<div class="w-50 fullM m-2 d-flex flex-column">
				<div class="card w-100 bg-light">
				  <div class="card-body">
					 <p>Please note that <strong>Full Name</strong> must contain at least <strong>First and Last Name</strong> preferably please a third name may be added.</p>
					 <p><strong>Date of Birth</strong> Age must at least 18 years old at the time of registration</p>
					 <p>Please provide at least a phone number and/or email address</p>
				  </div>
				</div>

				<div class="d-flex p-4 flex-column">
					<figure class="figure preview" style="margin-bottom: 20px;">
						<img src="#" id="preview" alt="" class="img-rounded w-75 ml-auto mr-auto">
						<figcaption class="figure-caption" id="ShowImage"></figcaption>
					</figure>
					<div class="form-group">
						<label class="">Upload Passport</label> &nbsp;
						<button type="button" id="upload_widget_opener" class="btn btn-success btn-lg">Click Here</button>
						<!-- <input type="file" title="Choose a Passport" id="passport" onchange="PreviewIcon()" class="btn-primary" accept="image/*"> -->
						<p><small class="text-primary">Click on the button above to select your <mark>Passport Image</mark></small></p>
					</div>
					<script src="http://widget.cloudinary.com/global/all.js" type="text/javascript"></script>
					<input type="hidden" name="passport" value="" id="passport">
					<script type="text/javascript">
					  document.getElementById("upload_widget_opener").addEventListener("click", function() {
					    cloudinary.openUploadWidget({ cloud_name: 'inidaname', upload_preset: 'adpnigeria'},
					      function(error, result) {
								$('#preview').attr('src', result[0].secure_url);
								$('#passport').val(result[0].secure_url)
							});
					  }, false);
					</script>

          <!-- collecting PVC number -->
          <div class="form-group">
            <label for="pvc">PVC Number <span class="text-muted">As displayed on your Voter Card</span></label>
            <input type="text" class="form-control" id="pvc_number" name="pvc" value="">
          </div>

					<!-- full name field -->
					<div class="form-group">
						<label for="full_name">Full Name</label>
						<input type="text" class="form-control" required name="full_name" id="full_name" placeholder="Full Name as displayed on Voter's Card">
						<div id="prFulname"></div>

					</div>

					<!-- phone number field  -->
					<div class="form-group">
						<label for="phone_number">Phone Number <i class="fa fa-asterisk" style="font-size: 7px;"></i></label>
						<input type="text" class="form-control input-phone" name="phone_number" required id="phone_number">
						<span id="valid-msg" class="d-none text-success">âœ“ Valid format</span>
						<span id="error-msg" class="d-none text-danger">Invalid number</span>
						<p class="is-invalid" id="phoneError"></p>
					</div>

					<!-- email field -->
					<div class="form-group">
						<label for="email">Email</label>
						<input type="email" class="form-control" name="email" id="email" placeholder="Email Address">
						<div class="invalid-feedback alert-danger" id="emailError">
							Please provide a valid email address
						</div>
					</div>

					<!-- gender select options -->
					<div class="form-group">
						<label for="gender">Gender</label>
						<select class="form-control" required name="gender" id="gender">
							<option>Gender</option>
							<option value="male">Male</option>
							<option value="female">Female</option>
						</select>
					</div>

					<!-- date of birth field -->
					<div class="form-group">
						<label for="dateofBirth">Date of Birth: <span class="text-muted">dd-mm-year</span></label>
						<input type="text" id="dateofBirth" required placeholder="01-12-1991" name="dateofBirth" class="form-control">
						<div class="is-Invalid" id="dateCheck">

						</div>
					</div>
				</div>
			</div>

			<!-- states and address registration -->
			<div class="w-50 fullM m-2 d-flex flex-column">
				<div class="card w-100 d-md-none bg-light">
				  <div class="card-body">
					  <p>Please select <strong>State</strong> where you are registered to vote, a list of all pulling units, wards and local govt area in the selected state will be available</p>
					  <!-- <p>You can search with your <strong>Local Govt. Area, Ward or Pulling Unit</strong> whichever maybe familiar to you</p>
					  <div class="input-group">
						  <input type="text" id="searchUnit" class="form-control" placeholder="Search for... Polling Unit, Local Govt.">
						  <span class="input-group-btn">
							  <button class="btn btn-primary" id="goSearch" type="button">Go!</button>
						  </span>
					  </div>

					  <small class="text-primary">Type name of your Polling Unit, Local Govt. eg <mark>Aso Rock, Lagos</mark> </small> -->
				  </div>
				</div>

				<div class="d-flex p-4 flex-column">
					<!-- select name of your state -->
					<div class="form-group">
						<label for="stateReg">State </label>
						<select class="form-control" required id="stateReg" name="stName"></select>
						<input type="hidden" id="grabST" name="stName" disabled class="form-control" value="">
					</div>
					<div class="form-group">
						<label for="localgovt">Local Government</label>
						<select id="localgovt" class="form-control" disabled  name="lgaName" placeholder=""></select>
						<input type="hidden" id="grabLGA" name="lgaName" disabled class="form-control" value="">

					</div>
					<div class="form-group">
						<label for="wardCT">Ward</label>
						<select id="wardCT" class="form-control" name="wardName" disabled placeholder=""></select>
						<input type="hidden" id="grabWARD" name="wardName" disabled class="form-control" value="">

					</div>
					<div class="form-group">
						<label for="pollingUnit">Your Voting Unit</label>
						<select id="pollingUnit" class="form-control" name="pollingUnit" disabled placeholder=""></select>
						<input type="hidden" id="grabPU" disabled name="pollingUnit" class="form-control" value="">

					</div>
					<div class="form-group">
						<label for="Resadd">Residential Address</label>
						<textarea type="text" id="Resadd" name="residenceAdd" class="form-control" placeholder=""></textarea>

					</div>
					<input type="hidden" name="Senatorial" id="senateSp" value="">
					<input type="hidden" name="FedConstituency" id="FedSp" value="">
					<input type="hidden" name="StateConstituency" id="stateConp" value="">
					<div class="form-group">
						<label for="countryRes">Country of Residence</label>
						<select required id="countryRes" data-role="country-selector" class="form-control" name="resCountry">
							<option value="">Select Your Country</option>
							{{#each country}}
							<option value="{{name}}">{{name}}</option>
							{{/each}}
						</select>
					</div>

					<div class="alert alert-info" role="alert">
					  <p>
					  	Senatorial District: <strong id="senatePat"></strong>
						</p>
						<p>
					  	Federal Constituency: <strong id="FedConPat"></strong>
					  </p>
					</div>

				</div>
			</div>
		</div>
		<div class="d-flex w-50 justify-content-around align-items-center align-content-center ml-auto mr-auto flex-column" style="margin: 5px 0;">
			<div class="alert alert-danger d-none" id="checkAll" role="alert">
			  Please Check Your errors above
			</div>
			<button type="submit" id="NextBtn" class="btn btn-primary btn-lg">Submit</button>
		</div>
	</form>
 </div>
</div>
<script type="text/javascript">
  document.onreadystatechange = function () {
    if (document.readyState === 'complete') {
      // phone validation
			var cleave = new Cleave('#loginPassword', {
				 phone: true,
				 phoneRegionCode: '{country}'
			});
      $.ajaxSetup({
        headers : {
          authorization: "{{header}}"
        }
      });


      			$('#phone_number').change(function(event) {
      					$.getJSON('http://192.169.231.145:8888/api/checkexist/'+$('#phone_number').val(), function(json, textStatus) {
                  $('#phoneError').html('')
                  $('#phone_number').removeClass('is-invalid')
                  $('#NextBtn').removeAttr('disabled');
      						if (json.success === true) {
      							$('#phoneError').html('already exist. <code>E66.3</code>')
      							$('#phone_number').addClass('is-invalid')
                    $('#NextBtn').attr('disabled', 'true');
      						} else {
                    $('#NextBtn').removeAttr('disabled');
                    $('#phoneError').html('')
                    $('#phone_number').removeClass('is-invalid')
      						}
      					});
      			});

      			// checking pvc
      			$('#pvc_number').change(function(event) {
      					$.getJSON('http://192.169.231.145:8888/api/checkpvc/'+$('#pvc_number').val(), function(json, textStatus) {
                  $('#pvc_error').html(' ')
                  $('#pvc_number').removeClass('is-invalid')
                  $('#NextBtn').removeAttr('disabled');
      						if (json.success === true) {
      							$('#pvc_error').html('already exist. <code>E66.3</code>')
      							$('#pvc_number').addClass('is-invalid')
                    $('#NextBtn').attr('disabled', 'true');
      						} else {
                    $('#pvc_error').html(' ')
                    $('#pvc_number').removeClass('is-invalid')
                    $('#NextBtn').removeAttr('disabled');
      						}
      					});
      			});

            //
      			// // phone validation
      			// var cleave = new Cleave('#phone_number', {
      			// 	 phone: true,
      			// 	 phoneRegionCode: '{country}'
      			// });
      			var cleave = new Cleave('#dateofBirth', {
      				date: true,
      			  delimiter: '-',
      				datePattern: ['d', 'm', 'Y']
      			});


    }
  }
</script>
